<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Inventaire (LocalStorage)</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .container { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        input, button { width: 100%; padding: 10px; margin: 8px 0; box-sizing: border-box; }
        button { background: #4285f4; color: white; border: none; cursor: pointer; }
        button.danger { background: #dc3545; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f2f2f2; }
    </style>
</head>
<body>
    <div class="container">
        <h2>‚ûï Ajouter une pi√®ce</h2>
        <input id="camion" placeholder="Camion (ex: CAM-001)">
        <input id="piece" placeholder="Pi√®ce (ex: PCE-101)">
        <input id="description" placeholder="Description">
        <button onclick="ajouterPiece()">Enregistrer</button>
        <p id="message"></p>
    </div>

    <div class="container">
        <h2>üìã Liste des pi√®ces</h2>
        <button onclick="exporterCSV()">üì§ Exporter en CSV</button>
        <button class="danger" onclick="resetData()">‚ôªÔ∏è Tout r√©initialiser</button>
        <table id="inventaireTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Camion</th>
                    <th>Pi√®ce</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        // Charger les donn√©es au d√©marrage
        document.addEventListener('DOMContentLoaded', () => {
            afficherInventaire();
        });

        // Ajouter une nouvelle pi√®ce
        function ajouterPiece() {
            const camion = document.getElementById('camion').value.trim();
            const piece = document.getElementById('piece').value.trim();
            const description = document.getElementById('description').value.trim();

            if (!camion || !piece) {
                alert("Camion et Pi√®ce sont obligatoires !");
                return;
            }

            const entree = {
                id: Date.now(),
                camion,
                piece,
                description,
                date: new Date().toISOString()
            };

            const historique = JSON.parse(localStorage.getItem('inventaire')) || [];
            historique.push(entree);
            localStorage.setItem('inventaire', JSON.stringify(historique));

            document.getElementById('message').textContent = "‚úÖ Pi√®ce ajout√©e !";
            document.getElementById('camion').value = '';
            document.getElementById('piece').value = '';
            document.getElementById('description').value = '';

            afficherInventaire();
        }

        // Afficher le tableau
        function afficherInventaire() {
            const tbody = document.querySelector('#inventaireTable tbody');
            tbody.innerHTML = '';

            const historique = JSON.parse(localStorage.getItem('inventaire')) || [];

            historique.forEach(entry => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${new Date(entry.date).toLocaleDateString()}</td>
                    <td>${entry.camion}</td>
                    <td>${entry.piece}</td>
                    <td>${entry.description || '-'}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Exporter en CSV
        function exporterCSV() {
            const historique = JSON.parse(localStorage.getItem('inventaire')) || [];
            let csv = "Date;Camion;Pi√®ce;Description\n";

            historique.forEach(entry => {
                csv += `${new Date(entry.date).toLocaleDateString()};${entry.camion};${entry.piece};${entry.description || ''}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `inventaire_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
        }

        // R√©initialiser toutes les donn√©es
        function resetData() {
            if (confirm("‚ö†Ô∏è Voulez-vous vraiment TOUT supprimer ? Cette action est irr√©versible !")) {
                localStorage.removeItem('inventaire');
                document.getElementById('message').textContent = "üóëÔ∏è Inventaire vid√© !";
                afficherInventaire();
            }
        }
    </script>
</body>
</html>
