<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Inventaire</title>
    <style>
        :root {
            --primary: #4a6bff;
            --light-bg: #f8f9fa;
            --border: #e0e0e0;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 25px;
            margin-bottom: 25px;
        }
        input, button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid var(--border);
            border-radius: 6px;
        }
        button {
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
        }
        .suggestions {
            display: flex;
            gap: 8px;
            margin: 5px 0;
        }
        .suggestion-chip {
            background: var(--light-bg);
            padding: 5px 10px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2>Ajouter une pièce</h2>
        <div>
            <label>Camion</label>
            <input id="camion" list="camion-history">
            <datalist id="camion-history"></datalist>
            <div class="suggestions" id="suggestions"></div>
        </div>
        <input id="piece" placeholder="Code pièce (ex: PCE-101)" required>
        <input id="description" placeholder="Description">
        <button onclick="ajouterPiece()">Enregistrer</button>
    </div>

    <script>
        // Charger l'historique des camions au démarrage
        document.addEventListener('DOMContentLoaded', () => {
            chargerHistoriqueCamions();
            const dernierCamion = localStorage.getItem('dernierCamion');
            if (dernierCamion) {
                document.getElementById('camion').value = dernierCamion;
            }
        });

        // Gestion des camions
        function chargerHistoriqueCamions() {
            const historique = JSON.parse(localStorage.getItem('historiqueCamions')) || [];
            const datalist = document.getElementById('camion-history');
            const suggestions = document.getElementById('suggestions');
            
            datalist.innerHTML = '';
            suggestions.innerHTML = '';
            
            historique.forEach(camion => {
                const option = document.createElement('option');
                option.value = camion;
                datalist.appendChild(option);
                
                const chip = document.createElement('div');
                chip.className = 'suggestion-chip';
                chip.textContent = camion;
                chip.onclick = () => {
                    document.getElementById('camion').value = camion;
                };
                suggestions.appendChild(chip);
            });
        }

        function ajouterPiece() {
            const camion = document.getElementById('camion').value.trim();
            const piece = document.getElementById('piece').value.trim();
            const description = document.getElementById('description').value.trim();

            if (!camion || !piece) {
                alert("Les champs Camion et Pièce sont obligatoires");
                return;
            }

            // Sauvegarder le camion pour plus tard
            const historiqueCamions = [...new Set([
                camion, 
                ...(JSON.parse(localStorage.getItem('historiqueCamions')) || [])
            ]).slice(0, 5); // Garder seulement les 5 derniers
            
            localStorage.setItem('historiqueCamions', JSON.stringify(historiqueCamions));
            localStorage.setItem('dernierCamion', camion);
            
            // Ajouter à l'inventaire (exemple)
            const inventaire = JSON.parse(localStorage.getItem('inventaire')) || [];
            inventaire.push({
                camion,
                piece,
                description,
                date: new Date().toISOString()
            });
            localStorage.setItem('inventaire', JSON.stringify(inventaire));
            
            alert("Pièce enregistrée !");
            document.getElementById('piece').value = '';
            document.getElementById('description').value = '';
            
            // Mettre à jour les suggestions
            chargerHistoriqueCamions();
        }
    </script>
</body>
</html>
