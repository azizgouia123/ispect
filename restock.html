<!DOCTYPE html>
<html>
<head>
    <title>Gestion Inventaire Simplifiée</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: 0 auto; padding: 20px; }
        input, button { display: block; width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; }
        button { background: #4285f4; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h2>Ajouter une pièce</h2>
    <input id="camion" placeholder="Numéro de camion">
    <input id="piece" placeholder="Code pièce">
    <input id="description" placeholder="Description">
    <button onclick="ajouterPiece()">Enregistrer</button>
    <p id="message"></p>

    <h2>Télécharger le rapport</h2>
    <button onclick="telechargerRapport()">Générer CSV</button>

    <script>
        // URL de votre script déployé
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwSrlEsweXaONxhoQi6IXTwBlHBDvOQsatt2pCJ-gcHS8jFW-I0JWxsjQVoYGhWe38BKw/exec";

        // Solution ultra-simple pour contourner CORS
        function ajouterPiece() {
            const camion = document.getElementById('camion').value;
            const piece = document.getElementById('piece').value;
            const description = document.getElementById('description').value;

            // Ouverture dans un nouvel onglet pour éviter CORS
            window.open(`${SCRIPT_URL}?action=add-item&camion=${encodeURIComponent(camion)}&piece=${encodeURIComponent(piece)}&description=${encodeURIComponent(description)}`, '_blank');
            
            document.getElementById('message').textContent = "Données envoyées !";
        }

        function telechargerRapport() {
            // Téléchargement direct via lien
            window.open(`${SCRIPT_URL}?action=get-report`, '_blank');
        }
    </script>
</body>
</html>
